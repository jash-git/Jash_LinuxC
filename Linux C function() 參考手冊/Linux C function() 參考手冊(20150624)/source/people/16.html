<html>
<head>
<title>Untitled Document</title>
</head>
<body>
<table width="100%">
  <tr> 
    <td width="80" valign="top">　 
      <div align="right"><br>
        <font face='宋體' size='2'><a name=linuxc293></a></font> </div>
    </td>
  </tr>
  <tr>
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> <br>
        </font> </div>
    </td>
    <td> <font face='宋體' size='2'> <br>
      getopt（分析命令行參數） </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 相關函數 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> <br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 表頭文件 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> #include&lt;unistd.h&gt;<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 定義函數 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> int getopt(int argc,char * const argv[ ],const 
      char * optstring);<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 函數說明 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> getopt()用來分析命令行參數。參數argc和argv是由main()傳遞的參數個數和內容。參數optstring 
      則代表欲處理的選項字符串。此函數會返回在argv 中下一個的選項字母，此字母會對應參數optstring 中的字母。如果選項字符串裡的字母后接著冒號“:”，則表示還有相關的參數，全域變量optarg 
      即會指向此額外參數。如果getopt()找不到符合的參數則會印出錯信息，並將全域變量optopt設為“?”字符，如果不希望getopt()印出錯信息，則只要將全域變量opterr設為0即可。<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 返回值 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> 如果找到符合的參數則返回此參數字母，如果參數不包含在參數optstring 的選項字母則返回“?”字符，分析結束則返回-1。<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 範例 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> #include&lt;stdio.h&gt;<br>
      #include&lt;unistd.h&gt;<br>
      int main(int argc,char **argv)<br>
      {<br>
      int ch;<br>
      opterr = 0;<br>
      while((ch = getopt(argc,argv,”a:bcde”))!= -1)<br>
      switch(ch)<br>
      {<br>
      case ‘a’:<br>
      printf(“option a:’%s’\n”,optarg);<br>
      break;<br>
      case ‘b’:<br>
      printf(“option b :b\n”);<br>
      break;<br>
      default:<br>
      printf(“other option :%c\n”,ch);<br>
      }<br>
      printf(“optopt +%c\n”,optopt);<br>
      }<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 執行 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> $./getopt –b<br>
      option b:b<br>
      $./getopt –c<br>
      other option:c<br>
      $./getopt –a<br>
      other option :?<br>
      $./getopt –a12345<br>
      option a:’12345’<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top">　 
      <div align="right"><br>
        <font face='宋體' size='2'><a name=linuxc294></a></font> </div>
    </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> <br>
        </font> </div>
    </td>
    <td> <font face='宋體' size='2'> <br>
      isatty（判斷文件描述詞是否是為終端機） </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 相關函數 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> ttyname<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 表頭文件 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> #include&lt;unistd.h&gt;<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 定義函數 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> int isatty(int desc);<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 函數說明 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> 如果參數desc所代表的文件描述詞為一終端機則返回1，否則返回0。<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 返回值 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> 如果文件為終端機則返回1，否則返回0。<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 範例 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> 參考ttyname()。<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top">　 
      <div align="right"><br>
        <font face='宋體' size='2'><a name=linuxc295></a></font> </div>
    </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> <br>
        </font> </div>
    </td>
    <td> <font face='宋體' size='2'> <br>
      select（I/O多工機制） </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 表頭文件 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> #include&lt;sys/time.h&gt;<br>
      #include&lt;sys/types.h&gt;<br>
      #include&lt;unistd.h&gt;<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 定義函數 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> int select(int n,fd_set * readfds,fd_set * 
      writefds,fd_set * exceptfds,struct timeval * timeout);<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 函數說明 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> select()用來等待文件描述詞狀態的改變。參數n代表最大的文件描述詞加1，參數readfds、writefds 
      和exceptfds 稱為描述詞組，是用來回傳該描述詞的讀，寫或例外的狀況。底下的宏提供了處理這三種描述詞組的方式:<br>
      FD_CLR(inr fd,fd_set* set)；用來清除描述詞組set中相關fd 的位<br>
      FD_ISSET(int fd,fd_set *set)；用來測試描述詞組set中相關fd 的位是否為真<br>
      FD_SET（int fd,fd_set*set）；用來設置描述詞組set中相關fd的位<br>
      FD_ZERO（fd_set *set）； 用來清除描述詞組set的全部位<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 參數 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> timeout為結構timeval，用來設置select()的等待時間，其結構定義如下<br>
      struct timeval<br>
      {<br>
      time_t tv_sec;<br>
      time_t tv_usec;<br>
      };<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 返回值 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> 如果參數timeout設為NULL則表示select（）沒有timeout。<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 錯誤代碼 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> 執行成功則返迴文件描述詞狀態已改變的個數，如果返回0代表在描述詞狀態改變前已超過timeout時間，當有錯誤發生時則返回-1，錯誤原因存於errno，此時參數readfds，writefds，exceptfds和timeout的值變成不可預測。<br>
      EBADF 文件描述詞為無效的或該文件已關閉<br>
      EINTR 此調用被信號所中斷<br>
      EINVAL 參數n 為負值。<br>
      ENOMEM 核心內存不足<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 範例 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> 常見的程序片段:fs_set readset；<br>
      FD_ZERO(&readset);<br>
      FD_SET(fd,&readset);<br>
      select(fd+1,&readset,NULL,NULL,NULL);<br>
      if(FD_ISSET(fd,readset){……}<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top">　 
      <div align="right"><br>
        <font face='宋體' size='2'><a name=linuxc296></a></font> </div>
    </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> <br>
        </font> </div>
    </td>
    <td> <font face='宋體' size='2'> <br>
      ttyname（返回一終端機名稱） </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 相關函數 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> Isatty<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 表頭文件 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> #include&lt;unistd.h&gt;<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 定義函數 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> char * ttyname(int desc);<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 函數說明 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> 如果參數desc所代表的文件描述詞為一終端機，則會將此終端機名稱由一字符串指針返回，否則返回NULL。<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 返回值 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> 如果成功則返回指向終端機名稱的字符串指針，有錯誤情況發生時則返回NULL。<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 範例 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> #include&lt;unistd.h&gt;<br>
      #include&lt;sys/types.h&gt;<br>
      #include &lt;sys/stat.h&gt;<br>
      #include&lt;fcntl.h&gt;<br>
      main()<br>
      {<br>
      int fd;<br>
      char * file = “/dev/tty”;<br>
      fd = open (fiel,O_RDONLY);<br>
      printf(“%s”,file);<br>
      if(isatty(fd)){<br>
      printf(“is a tty.\n”);<br>
      printf(“ttyname = %s \n”,ttyname(fd));<br>
      }<br>
      else printf(“ is not a tty\n”);<br>
      close(fd);<br>
      }<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top"> 
      <div align="right"><font face='宋體' size='2'> 執行 </font> </div>
    </td>
    <td> <font face='宋體' size='2'> /dev/tty is a tty<br>
      ttyname = /dev/tty<br>
      </font> </td>
  </tr>
  <tr> 
    <td width="80" valign="top">　 
      <div align="right"><br>
      </div>
    </td>
  </tr>
</table>
</body>
</html>
