/*jslint undef: true, newcap: true, nomen: true, regexp: true, bitwise: true, browser: true, *//*global jQuery, pix, pixlang, tinymce, _, *//*!
 * Copyright (c) 2008-2011, PIXNET Digital Media Corporation.
 * All rights reserved.
 *//* load sprintf */document.write('<script type="text/javascript" src="//s.pixfs.net/js/tools/tools.min.js"></script>');var _=_||function(e){return e},pix=pix||{};pix.p=pix.p||{profile:{},friend:{},alb:{},blog:{},club:{},gb:{},acct:{}},pix.f=pix.f||{profile:{},friend:{},alb:{},alb2:{},blog:{},club:{},gb:{},acct:{}},pix.v=pix.v||{},pix.changeCheck={Changed:!1,check:!1,confirmMsg:_("您已經變更了設定值但是尚未儲存，你確定要離開本頁嗎？"),unload_cb:function(e){var t=pix.changeCheck;e||(e=window.event);if(t.Changed&&t.check)return e.returnValue=t.confirmMsg,t.confirmMsg},init:function(e){var t=pix.changeCheck;t.Changed=!1,t.check=!0,jQuery(e).change(function(){t.Changed=!0}),jQuery(function(){window.onbeforeunload=t.unload_cb})},change:function(){pix.changeCheck.Changed=!0},reset:function(){pix.changeCheck.Changed=!1}},pix.SlideShow={Speed:2e3,crossFadeDuration:3,pos:0,_init:function(e){var t=this;t.Pic=[],t.preLoadPic=[],t.Id=e},load:function(e){var t=this;t.Pic.push(e)},preLoad:function(e){var t=this;""!==t.Pic[e]&&(window.status="Loading : "+t.Pic[e],t.preLoadPic[e]=new Image,t.preLoadPic[e].src=t.Pic[e],t.Pic[e]="",window.status="")},start:function(){function t(){var t=document.getElementById(e.Id);document.all&&(t.style.filter="blendTrans(duration=2)",t.style.filter="blendTrans(duration=crossFadeDuration)",t.filters.blendTrans.Apply()),t.src=e.preLoadPic[e.pos].src,document.all&&t.filters.blendTrans.Play(),e.pos++,e.pos>e.Pic.length-1&&(e.pos=0),e.preLoad(e.pos)}var e=this;if(0===e.Pic.length)return;e.preLoad(e.pos),t(),setInterval(t,e.Speed)}},pix.escape_re=function(e){return e.replace(/([.?*+\^$\[\]\\(){}\|])/g,"\\$1")},pix.htmlspecialchars_decode=function(e,t){return null===e?"":(e=e.toString(),e=e.replace(/&amp;/g,"&"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&quot;/g,'"'),t=="ENT_QUOTES"&&(e=e.replace(/&#039;/g,"'")),e)},pix.htmlfilterbr=function(e,t){return null===e?"":(e=e.toString(),e=e.replace(/<[bB][Rr][^>]*>/g,"\n"),e)},pix.htmlspecialchars=function(e,t){return null===e?"":(e=e.toString(),e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/"/g,"&quot;"),"ENT_QUOTES"==t&&(e=e.replace(/'/g,"&#039;")),e)},pix.addUrlParam=function(e,t){var n=location.href.split("?")[0],r=new Array;if("undefined"!=typeof location.href.split("?")[1]&&location.href.split("?")[1].length){r=location.href.split("?")[1].split("&");for(var i=0;i<r.length;i++)if(r[i].split("=")[0]==e){r.splice(i,1);break}}return r.push(e+"="+t),link=n+"?"+r.join("&"),link},pix.defTinyMCE=function(){return typeof window.tinyMCE!="undefined"?!0:!1},pix.tinymce_init_instance_callback=function(e){function t(){var t=e.selection.getBookmark(2,!0);e.getBody().childNodes.length!==0&&(pix.v.cursorPosition=t)}function n(e){e.selection.moveToBookmark(pix.v.cursorPosition)}function r(){pix.v.cursorPosition=null}function i(){pix.v.editorChanged=!0}tinyMCE.execCommand("mceFocus",!1,e.id),tinymce.isIE&&(e.getDoc().attachEvent("onbeforedeactivate",function(){pix.v.mceContextMenu?(pix.v.mceContextMenu=!1,r()):t()}),e.onContextMenu.add(function(e,t){pix.v.mceContextMenu=!0,t.ctrlKey&&r(e)}),e.onClick.add(function(e,t){pix.v.mceContextMenu=!1,r()}),e.onBeforeExecCommand.add(function(e,t,i,s){"mceInsertContent"==t&&pix.v.cursorPosition&&(n(e),r())}),e.onActivate.add(function(){r()})),e.onChange.add(i),e.onExecCommand.add(i),e.onKeyDown.add(i)},pix.rawdata=function(e){return this.flag=this.flag||jQuery("<div>\n</div>").text()=="\n",this.flag?jQuery(e).text():pix.htmlspecialchars_decode(pix.htmlfilterbr(jQuery(e).html()))},pix.p.popupLoader=function(e){"function"!=typeof pix.p.popup_cb&&(pix.p.popup_cb=undefined),pix.popup_cancel=function(){pix.p.hidebox()},jQuery("#popup-body .content").load(e,null,pix.p.showbox)},window.size=function(){var e=0,t=0;return window.innerWidth?(e=window.innerWidth,t=window.innerHeight):document.documentElement.clientWidth!==0?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):(e=document.body.clientWidth,t=document.body.clientHeight),{width:e,height:t}},pix.p.showbox=function(){jQuery("#page-body select").hide(),jQuery("#overlay").show().css("opacity","0.5");var e=jQuery("#popup-box").css("left",(jQuery(window).width()-jQuery("#popup-box").width())/2).css("top",(jQuery(window).height()-jQuery("#popup-box").height())/2).show();e.draggable&&e.draggable({handle:"#popup-header",cancel:":input, button, option"}),pix.p.popupfocus(),undefined!==pix.p.popup_cb&&pix.p.popup_cb()},pix.p.popupfocus=function(){jQuery("#popup-form :input:not(:hidden):first").focus()},pix.p.hidebox=function(){jQuery("#page-body select").show(),jQuery("#overlay").hide().css("opacity","1"),jQuery("#popup-submit-btn").removeAttr("disabled").find("span").text(_("送出")).end().show(),jQuery("#popup-cancel-btn").find("span").text(_("取消")).end().show(),jQuery("#popup-box").hide(),pix.popup_submit=null,500!=jQuery("#popup-box").width()&&pix.p.boxnormal()},pix.p.togglebox=function(){var e=jQuery("#popup-box").width();500==e?pix.p.boxfull():pix.p.boxnormal()},pix.p.boxnormal=function(){var e=500,t=400,n=jQuery("#popup-box").width(e).height(t).css("left",(jQuery(window).width()-e)/2).css("top",(jQuery(window).height()-t)/2);n.draggable&&n.draggable({handle:jQuery("#popup-header"),cancel:":input, button, option"})},pix.p.boxfull=function(){var e=jQuery(window).width(),t=jQuery(window).height(),n=jQuery("#popup-box").width(e*.95).height(t*.95).css("left",e*.05/2).css("top",t*.05/2)},pix.p.boxfit=function(){var e=jQuery(window),t=jQuery("#popup-box"),n=jQuery("#popup-body"),r=n[0].scrollWidth-n[0].clientWidth,i=n[0].scrollHeight-n[0].clientHeight;t.width(Math.min(e.width(),t.width()+r)).height(Math.min(e.height(),t.height()+i)).css("left",(e.width()-t.width())/2).css("top",(e.height()-t.height())/2)},pix.p.validCameraFileName=pix.p.validCameraFileName||{skip:null,type:null,init:function(e){return jQuery.cookie&&(this.skip=jQuery.cookie("valid_camera_nevernotify")),this.skip?!0:e.match(/^(CIMG|DSC_|DSCF|DSCN|DSC|DUW|IMG|JD|MGP|S700|PICT|IMAG|untitled|未命名)[_0-9]*\.(JPG|JPEG|GIF|PNG)$/i)?this.switchConfirm():e.match(/.+\.(jpg|jpeg|gif|png)$/i)?this.switchConfirm():!0},switchConfirm:function(){return"panel"===this.type?this.confirmPanel():this.confirmFront()},confirmFront:function(){return confirm(_("您使用的檔名（含IMG、DSC等常用相機預設檔名）可能會被系統判定為相機預設檔名，將無法於前台顯示，請確認是否要儲存？"))?!0:!1},confirmPanel:function(){pix.p.confirm("",_("您使用的檔名（含IMG、DSC等常用相機預設檔名）可能會被系統判定為相機預設檔名，將無法於前台顯示，請確認是否要儲存？"),function(e,t){t&&t.note&&t.note.neveragain&&(pix.p.validCameraFileName.skip=!0,jQuery.cookie("valid_camera_nevernotify",1,{expires:365,path:"/",secure:!1}))},{type:"warning",option:{yes:_("確認")},note:{neveragain:_("不要再提示我")}})}},pix.preferences={_ccsites:new Array("panel"),set:function(e,t,n,r){"undefined"==typeof n&&(n="panel"),"undefined"==typeof pix.panelsite&&(pix.panelsite="panel.pixnet.cc"),"function"!=typeof r&&(r=function(){}),jQuery.get("http://"+pix.panelsite+"/settings/setpreference?key="+e+"&value="+t+"&site="+n,r,"jsonp")},get:function(e,t){"undefined"==typeof t&&(t="panel");var n;if(-1!==jQuery.inArray(t,this._ccsites)){var r=jQuery.parseJSON(jQuery.cookie("preferences"))||{};"undefined"!=typeof r[t]&&(n=r[t])}else n=jQuery.parseJSON(jQuery.cookie("preferences"))||{};return"undefined"!=typeof n&&"undefined"!=typeof n[e]?n[e]:!1}},function(e){function t(t){var n=e(this).closest("form");if(n.length===0)return!0;if(t.type=="keydown"&&t.keyCode!=13)return!0;if(t.type=="click"&&t.button!==0)return!0;if(n.hasClass("oneTimeForm")){if(n.data("submitted")===!0)return!1;n.data("submitted",!0)}return!0}e(function(){e("input[type=submit]").live("click keydown",t),e("button[type=submit]").live("click keydown",t)}),e(function(){e(".trace-click").each(function(){e(this).is("a")||e(this).append('<a href="'+e(this).attr("data-link")+'" target="_blank" style="width:'+e(this).width()+"px;height:"+e(this).height()+"px;top:0px;left:0px;z-index:"+(parseInt(e(this).css("z-index")?e(this).css("z-index"):0)+1)+';position:absolute;"></a>')}),e(".trace-click").live("click",function(t){if(!e(this).attr("data-counterlink"))return;var n=e(this),r,i,s=!1;n.is("a")?(r=n.attr("href"),i=n.attr("target")):(r=n.attr("data-link"),i=n.attr("data-target")),i&&i!==window.name?s=!0:t.metaKey||t.shiftKey||t.ctrlKey||t.altKey?s=!0:t.button&&t.button!==1?s=!0:t.which&&t.which!==1&&(s=!0),s||t.preventDefault();var o=new Image(1,1);o.src=n.attr("data-counterlink"),o.onload=function(){s||(document.location.href=r)},o.onerror=function(){s||(document.location.href=r)}})})}(jQuery),jQuery(function(){if(!jQuery.hotkeys||!jQuery.hotkeys.version)return;jQuery(document).bind("keydown","z",function(){jQuery("link[rel=first]").attr("href")!==undefined&&"#"!=jQuery("link[rel=first]").attr("href")&&(window.location.href=jQuery("link[rel=first]").attr("href"))}),jQuery(document).bind("keydown","x",function(){jQuery("link[rel=prev]").attr("href")!==undefined&&"#"!=jQuery("link[rel=prev]").attr("href")&&(window.location.href=jQuery("link[rel=prev]").attr("href"))}),jQuery(document).bind("keydown","c",function(){jQuery("link[rel=next]").attr("href")!==undefined&&"#"!=jQuery("link[rel=next]").attr("href")&&(window.location.href=jQuery("link[rel=next]").attr("href"))}),jQuery(document).bind("keydown","v",function(){jQuery("link[rel=last]").attr("href")!==undefined&&"#"!=jQuery("link[rel=last]").attr("href")&&(window.location.href=jQuery("link[rel=last]").attr("href"))}),jQuery(document).bind("keydown","b",function(){jQuery("link[rel=up]").attr("href")!==undefined&&"#"!=jQuery("link[rel=up]").attr("href")&&(window.location.href=jQuery("link[rel=up]").attr("href"))}),jQuery(document).bind("keydown","right",function(){jQuery("link[rel=next]").attr("href")!==undefined&&"#"!=jQuery("link[rel=next]").attr("href")&&(window.location.href=jQuery("link[rel=next]").attr("href"))}),jQuery(document).bind("keydown","left",function(){jQuery("link[rel=prev]").attr("href")!==undefined&&"#"!=jQuery("link[rel=prev]").attr("href")&&(window.location.href=jQuery("link[rel=prev]").attr("href"))})}),pix.iframePopup={init:function(e,t,n,r,i,s){jQuery(n).click(function(n){jQuery(e).find("h3").text(i);var r=jQuery(e).show(),o=r.find("#frame-content"),u=s.width||650;o.html('<iframe width="100%" height="100%" frameborder="0" src="'+t+'"></iframe>').width(u),s.height?o.height(s.height):o.height(Math.floor(.7*window.size().height));var a=o.find("iframe");return a.load(function(){r.css("z-index",2147483647)}),jQuery.browser.msie&&jQuery.browser.version<8?jQuery(document.documentElement).css("overflow","hidden"):jQuery("html").css("overflow","hidden"),!1}),jQuery(r).click(function(){jQuery.browser.msie&&jQuery.browser.version<8?jQuery(document.documentElement).css("overflow",""):jQuery("html").css("overflow","");var t=jQuery(e);return t.hide(),!1})},preClick:function(){jQuery.each(pix.albumPopInfo.elems,function(){this[2]&&this[2].hide&&this[2].hide()})},click:function(e,t,n){e.show().visible().setSafePageX(t.pageX).css("top",t.pageY);var r=function(e){return function(){e.hide(),jQuery("body").unbind("click",r)}}(e);jQuery("body").click(r),typeof n=="string"&&e.load(n)}},pix.countDate=function(e,t){10===e.toString().length&&(e=parseInt(e*1e3)),"undefined"==typeof t?t=new Date:10===t.toString().length?t=new Date(t*1e3):t=new Date(t);var n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=n-e;if(!(r<=0))return r<=864e5?pixlang.countDate_yesterday:r>864e5&&r<=2592e6?Math.ceil(r/1e3/86400)+pixlang.countDate_days:r>2592e6?Math.ceil(r/1e3/86400/30)+pixlang.countDate_months:pixlang.countDate_overthreemonths;var i=t-e;if(i<=36e5)return Math.ceil(i/1e3/60)+pixlang.countDate_minutes;if(i>36e5&&i<=864e5)return Math.ceil(i/1e3/3600)+pixlang.countDate_hours},pix.formatDatetime=function(e){10===e.toString().length&&(e=parseInt(e*1e3));var t=new Date(e),n=[t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()];for(var r in n)n[r]<10&&(n[r]="0"+n[r]);return t.getFullYear()+"/"+n[0]+"/"+n[1]+" "+n[2]+":"+n[3]+":"+n[4]};